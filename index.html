<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>AAC Symbiont MAX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* FIX wysokości i blokada gestów */
        body {
            height: 100vh;
            height: 100dvh;
            touch-action: manipulation; 
            user-select: none; 
            -webkit-user-select: none; 
            overscroll-behavior: none;
        }
        .safe-bottom {
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }
        /* Efekt wciskania */
        .btn-press:active { 
            transform: scale(0.96); 
            transition: transform 0.05s;
            background-color: #1e40af; /* Ciemniejszy niebieski */
        }
    </style>
</head>
<body class="bg-gray-900 w-screen flex flex-col p-2 gap-2 overflow-hidden">

    <div id="display" class="bg-gray-800 text-white text-4xl md:text-6xl font-black rounded flex items-center justify-center p-2 h-[15vh] border-4 border-gray-600 shadow-lg text-center break-words leading-tight uppercase">
        ...
    </div>

    <div class="grid grid-cols-5 gap-2 flex-grow min-h-0">
        </div>

    <div class="flex gap-2 h-[15vh] min-h-[80px] mt-1 safe-bottom">
        <button onclick="addSpace()" class="flex-grow bg-gray-600 active:bg-gray-500 text-white text-2xl md:text-4xl font-black rounded shadow-lg btn-press uppercase tracking-widest border-2 border-gray-500">ODSTĘP</button>
        <button onclick="backspace()" class="w-1/4 bg-red-800 active:bg-red-700 text-white text-3xl md:text-5xl font-black rounded shadow-lg btn-press border-2 border-red-600">DEL</button>
        <button onclick="speak()" class="w-1/4 bg-green-700 active:bg-green-600 text-white text-3xl md:text-5xl font-black rounded shadow-lg btn-press border-2 border-green-600">MÓW</button>
    </div>

    <div class="flex justify-between items-center text-gray-600 text-[10px] px-1 h-4">
        <span>v3.0 MAX</span>
        <button onclick="downloadLogs()" class="hover:text-gray-400">LOGI</button>
    </div>

<script>
    // --- KONFIGURACJA MAX ---
    // Usunięte polskie znaki, tylko bazowe A-Z
    const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    
    let currentText = "";
    const display = document.getElementById('display');
    const grid = document.querySelector('.grid');

    // --- GENEROWANIE SIATKI ---
    alphabet.split('').forEach(char => {
        const btn = document.createElement('button');
        btn.innerText = char;
        // Stylizacja: Font Black (bardzo gruby), ogromny rozmiar
        btn.className = "bg-blue-700 text-white text-4xl md:text-6xl font-black rounded shadow-md btn-press w-full h-full flex items-center justify-center border-2 border-blue-500";
        btn.onclick = () => addChar(char);
        grid.appendChild(btn);
    });

    // --- LOGIKA ---
    function updateDisplay() {
        display.innerText = currentText === "" ? "..." : currentText;
    }

    function addChar(char) {
        currentText += char;
        updateDisplay();
    }

    function addSpace() {
        currentText += " ";
        updateDisplay();
    }

    function backspace() {
        currentText = currentText.slice(0, -1);
        updateDisplay();
    }

    function speak() {
        if (!currentText) return;

        const utterance = new SpeechSynthesisUtterance(currentText);
        utterance.lang = 'pl-PL';
        utterance.rate = 0.9;
        window.speechSynthesis.speak(utterance);

        saveLog(currentText);
    }

    function saveLog(text) {
        const logs = JSON.parse(localStorage.getItem('aac_logs') || "[]");
        const timestamp = new Date().toLocaleString('pl-PL');
        logs.push(`[${timestamp}] ${text}`);
        localStorage.setItem('aac_logs', JSON.stringify(logs));
    }

    function downloadLogs() {
        const logs = JSON.parse(localStorage.getItem('aac_logs') || "[]");
        if (logs.length === 0) {
            alert("Brak historii.");
            return;
        }
        const blob = new Blob([logs.join('\n')], { type: 'text/plain' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `aac_log_${new Date().toISOString().slice(0,10)}.txt`;
        a.click();
    }

    // Blokada zoomowania
    document.addEventListener('dblclick', function(event) {
        event.preventDefault();
    }, { passive: false });
</script>
</body>
</html>
